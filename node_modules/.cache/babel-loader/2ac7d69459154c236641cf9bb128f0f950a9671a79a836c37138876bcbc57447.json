{"ast":null,"code":"import { logout } from '@/api/api';\nconst state = {\n  token: \"\",\n  user: \"\"\n};\nconst getters = {\n  getToken(state) {\n    if (state.token) {\n      return state.token;\n    } else {\n      return window.localStorage.getItem(\"token\");\n    }\n  },\n  getUser(state) {\n    if (state.user) {\n      return state.user;\n    } else {\n      return window.localStorage.getItem(\"user\");\n    }\n  }\n};\nconst mutations = {\n  setToken(state, token) {\n    state.token = token;\n    window.localStorage.setItem(\"token\", token);\n  },\n  setUser(state, user) {\n    state.user = user;\n    window.localStorage.setItem(\"user\", user);\n  }\n};\nconst actions = {\n  logout({\n    commit\n  }) {\n    return new Promise((resolve, reject) => {\n      // 调用后端登出接口\n      logout().then(() => {\n        commit('setToken', '');\n        commit('setUser', '');\n        window.localStorage.removeItem(\"token\");\n        window.localStorage.removeItem(\"user\");\n        resolve();\n      }).catch(error => {\n        // 即使登出API失败也清除本地状态\n        commit('setToken', '');\n        commit('setUser', '');\n        window.localStorage.removeItem(\"token\");\n        window.localStorage.removeItem(\"user\");\n        resolve(); // 仍然resolve以确保流程继续\n      });\n    });\n  }\n};\nexport default {\n  namespaced: true,\n  state,\n  getters,\n  mutations,\n  actions\n};","map":{"version":3,"names":["logout","state","token","user","getters","getToken","window","localStorage","getItem","getUser","mutations","setToken","setItem","setUser","actions","commit","Promise","resolve","reject","then","removeItem","catch","error","namespaced"],"sources":["D:/edu-hub-admin-frontend/src/store/modules/user.js"],"sourcesContent":["import { logout } from '@/api/api'\r\nconst state = {\r\n  token: \"\",\r\n  user: \"\",\r\n}\r\nconst getters ={\r\n  getToken(state) {\r\n    if (state.token) {\r\n      return state.token\r\n    } else {\r\n      return window.localStorage.getItem(\"token\")\r\n    }\r\n  },\r\n  getUser(state) {\r\n    if (state.user) {\r\n      return state.user\r\n    } else {\r\n      return window.localStorage.getItem(\"user\")\r\n    }\r\n  }\r\n}\r\n  \r\nconst mutations = {\r\n    setToken(state,token) {\r\n      state.token = token\r\n      window.localStorage.setItem(\"token\",token)\r\n    },\r\n    setUser(state,user) {\r\n      state.user = user\r\n      window.localStorage.setItem(\"user\",user)\r\n    }\r\n}\r\n\r\nconst actions = {\r\n  logout({ commit }) {\r\n    return new Promise((resolve, reject) => {\r\n      // 调用后端登出接口\r\n      logout().then(() => {\r\n        commit('setToken', '')\r\n        commit('setUser', '')\r\n        window.localStorage.removeItem(\"token\")\r\n        window.localStorage.removeItem(\"user\")\r\n        resolve()\r\n      }).catch(error => {\r\n        // 即使登出API失败也清除本地状态\r\n        commit('setToken', '')\r\n        commit('setUser', '')\r\n        window.localStorage.removeItem(\"token\")\r\n        window.localStorage.removeItem(\"user\")\r\n        resolve() // 仍然resolve以确保流程继续\r\n      })\r\n    })\r\n  }\r\n}\r\n  \r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  getters,\r\n  mutations,\r\n  actions\r\n}\r\n  "],"mappings":"AAAA,SAASA,MAAM,QAAQ,WAAW;AAClC,MAAMC,KAAK,GAAG;EACZC,KAAK,EAAE,EAAE;EACTC,IAAI,EAAE;AACR,CAAC;AACD,MAAMC,OAAO,GAAE;EACbC,QAAQA,CAACJ,KAAK,EAAE;IACd,IAAIA,KAAK,CAACC,KAAK,EAAE;MACf,OAAOD,KAAK,CAACC,KAAK;IACpB,CAAC,MAAM;MACL,OAAOI,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC7C;EACF,CAAC;EACDC,OAAOA,CAACR,KAAK,EAAE;IACb,IAAIA,KAAK,CAACE,IAAI,EAAE;MACd,OAAOF,KAAK,CAACE,IAAI;IACnB,CAAC,MAAM;MACL,OAAOG,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;IAC5C;EACF;AACF,CAAC;AAED,MAAME,SAAS,GAAG;EACdC,QAAQA,CAACV,KAAK,EAACC,KAAK,EAAE;IACpBD,KAAK,CAACC,KAAK,GAAGA,KAAK;IACnBI,MAAM,CAACC,YAAY,CAACK,OAAO,CAAC,OAAO,EAACV,KAAK,CAAC;EAC5C,CAAC;EACDW,OAAOA,CAACZ,KAAK,EAACE,IAAI,EAAE;IAClBF,KAAK,CAACE,IAAI,GAAGA,IAAI;IACjBG,MAAM,CAACC,YAAY,CAACK,OAAO,CAAC,MAAM,EAACT,IAAI,CAAC;EAC1C;AACJ,CAAC;AAED,MAAMW,OAAO,GAAG;EACdd,MAAMA,CAAC;IAAEe;EAAO,CAAC,EAAE;IACjB,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC;MACAlB,MAAM,CAAC,CAAC,CAACmB,IAAI,CAAC,MAAM;QAClBJ,MAAM,CAAC,UAAU,EAAE,EAAE,CAAC;QACtBA,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC;QACrBT,MAAM,CAACC,YAAY,CAACa,UAAU,CAAC,OAAO,CAAC;QACvCd,MAAM,CAACC,YAAY,CAACa,UAAU,CAAC,MAAM,CAAC;QACtCH,OAAO,CAAC,CAAC;MACX,CAAC,CAAC,CAACI,KAAK,CAACC,KAAK,IAAI;QAChB;QACAP,MAAM,CAAC,UAAU,EAAE,EAAE,CAAC;QACtBA,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC;QACrBT,MAAM,CAACC,YAAY,CAACa,UAAU,CAAC,OAAO,CAAC;QACvCd,MAAM,CAACC,YAAY,CAACa,UAAU,CAAC,MAAM,CAAC;QACtCH,OAAO,CAAC,CAAC,EAAC;MACZ,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;AACF,CAAC;AAED,eAAe;EACbM,UAAU,EAAE,IAAI;EAChBtB,KAAK;EACLG,OAAO;EACPM,SAAS;EACTI;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}