{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { getUserPage, removeUser, resetPassword, getApeSchoolList } from '../../../api/api';\nimport addUser from \"../../../components/system/teacher/addTeacher\";\nimport updateUser from \"../../../components/system/teacher/updateTeacher\";\nexport default {\n  components: {\n    addUser,\n    updateUser\n  },\n  data() {\n    return {\n      loading: false,\n      update: [],\n      addUserVisible: false,\n      updateUserVisible: false,\n      passwordDialogVisible: false,\n      updateId: \"\",\n      userName: \"\",\n      newPassword: \"\",\n      search: {\n        userName: \"\",\n        tel: \"\",\n        school: \"\",\n        major: \"\",\n        pageNumber: 1,\n        pageSize: 10\n      },\n      total: 0,\n      tableData: [],\n      school: []\n    };\n  },\n  mounted() {\n    this.getSchools();\n    this.query();\n  },\n  methods: {\n    getSchools() {\n      getApeSchoolList().then(res => {\n        if (res.code === 1000) this.school = res.data;\n      });\n    },\n    query() {\n      this.loading = true;\n      getUserPage(this.search).then(res => {\n        if (res.code === 1000) {\n          this.tableData = res.data.records;\n          this.total = res.data.total;\n        }\n        this.loading = false;\n      });\n    },\n    refresh() {\n      this.search = {\n        ...this.search,\n        userName: \"\",\n        tel: \"\",\n        school: \"\",\n        major: \"\",\n        pageNumber: 1\n      };\n      this.query();\n    },\n    handleSizeChange(val) {\n      this.search.pageSize = val;\n      this.query();\n    },\n    handleCurrentChange(val) {\n      this.search.pageNumber = val;\n      this.query();\n    },\n    handleSelectionChange(val) {\n      this.update = val.map(item => item.id);\n    },\n    addUser() {\n      this.addUserVisible = true;\n    },\n    addUserFalse() {\n      this.addUserVisible = false;\n      this.query();\n    },\n    updateUser(id) {\n      this.updateId = id;\n      this.updateUserVisible = true;\n    },\n    updateUserBtn() {\n      if (this.update.length === 1) this.updateUser(this.update[0]);\n    },\n    updateUserFalse() {\n      this.updateUserVisible = false;\n      this.query();\n    },\n    handleCommand(command) {\n      const [id, action, name] = command.split('#');\n      if (action === 'edit') this.updateUser(id);else if (action === 'pass') {\n        this.userName = name;\n        this.userId = id;\n        this.passwordDialogVisible = true;\n      } else this.deleteDate(id);\n    },\n    deleteDateBtn() {\n      if (this.update.length > 0) {\n        this.$confirm('确认删除选中教师?', '提示', {\n          type: 'warning'\n        }).then(() => this.deleteDate(this.update.join(\",\")));\n      }\n    },\n    deleteDate(ids) {\n      removeUser({\n        ids\n      }).then(res => {\n        if (res.code === 1000) {\n          this.$message.success('删除成功');\n          this.query();\n        }\n      });\n    },\n    passwordSubmit() {\n      if (!this.newPassword) return this.$message.warning('请输入密码');\n      resetPassword({\n        id: this.userId,\n        newPassword: this.newPassword\n      }).then(res => {\n        if (res.code === 1000) {\n          this.$message.success('重置成功');\n          this.passwordDialogVisible = false;\n          this.newPassword = \"\";\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["getUserPage","removeUser","resetPassword","getApeSchoolList","addUser","updateUser","components","data","loading","update","addUserVisible","updateUserVisible","passwordDialogVisible","updateId","userName","newPassword","search","tel","school","major","pageNumber","pageSize","total","tableData","mounted","getSchools","query","methods","then","res","code","records","refresh","handleSizeChange","val","handleCurrentChange","handleSelectionChange","map","item","id","addUserFalse","updateUserBtn","length","updateUserFalse","handleCommand","command","action","name","split","userId","deleteDate","deleteDateBtn","$confirm","type","join","ids","$message","success","passwordSubmit","warning"],"sources":["src/views/system/teacher/teacher.vue"],"sourcesContent":["<template>\r\n  <div class=\"teacher-container\">\r\n    <!-- 搜索区域 -->\r\n    <div class=\"search-card\">\r\n      <el-row :gutter=\"10\">\r\n        <el-col :xs=\"24\" :sm=\"12\" :md=\"8\" :lg=\"6\">\r\n          <el-input\r\n            v-model=\"search.userName\"\r\n            placeholder=\"教师名称\"\r\n            prefix-icon=\"el-icon-user\"\r\n            clearable\r\n            size=\"small\">\r\n          </el-input>\r\n        </el-col>\r\n        <el-col :xs=\"24\" :sm=\"12\" :md=\"8\" :lg=\"6\">\r\n          <el-input\r\n            v-model=\"search.tel\"\r\n            placeholder=\"手机号码\"\r\n            prefix-icon=\"el-icon-phone\"\r\n            clearable\r\n            size=\"small\">\r\n          </el-input>\r\n        </el-col>\r\n        <el-col :xs=\"24\" :sm=\"12\" :md=\"8\" :lg=\"6\">\r\n          <el-select\r\n            v-model=\"search.school\"\r\n            placeholder=\"学校\"\r\n            prefix-icon=\"el-icon-school\"\r\n            clearable\r\n            size=\"small\"\r\n            style=\"width:100%\">\r\n            <el-option\r\n              v-for=\"item in school\"\r\n              :key=\"item.id\"\r\n              :label=\"item.name\"\r\n              :value=\"item.name\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-col>\r\n        <el-col :xs=\"24\" :sm=\"12\" :md=\"8\" :lg=\"6\">\r\n          <el-button type=\"primary\" size=\"small\" @click=\"query\">查询</el-button>\r\n          <el-button size=\"small\" @click=\"refresh\">重置</el-button>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n\r\n    <!-- 操作按钮 -->\r\n    <div class=\"action-bar\">\r\n      <el-button type=\"primary\" size=\"small\" icon=\"el-icon-plus\" @click=\"addUser\">新增</el-button>\r\n      <el-button \r\n        type=\"success\" \r\n        size=\"small\" \r\n        icon=\"el-icon-edit\" \r\n        :disabled=\"update.length !== 1\"\r\n        @click=\"updateUserBtn\">\r\n        修改\r\n      </el-button>\r\n      <el-popconfirm\r\n        title=\"确认删除选中教师？\"\r\n        @confirm=\"deleteDateBtn\">\r\n        <el-button \r\n          slot=\"reference\" \r\n          type=\"danger\" \r\n          size=\"small\" \r\n          icon=\"el-icon-delete\" \r\n          :disabled=\"update.length === 0\">\r\n          删除\r\n        </el-button>\r\n      </el-popconfirm>\r\n    </div>\r\n\r\n    <!-- 数据表格 -->\r\n    <el-table\r\n      :data=\"tableData\"\r\n      v-loading=\"loading\"\r\n      @selection-change=\"handleSelectionChange\"\r\n      stripe\r\n      style=\"width:100%\"\r\n      class=\"data-table\">\r\n      <el-table-column type=\"selection\" width=\"45\"></el-table-column>\r\n      <el-table-column label=\"教师\" width=\"180\">\r\n        <template v-slot=\"{row}\">\r\n          <div class=\"teacher-info\">\r\n            <el-avatar :size=\"35\" :src=\"$store.state.configure.HOST + row.avatar\"></el-avatar>\r\n            <div class=\"teacher-detail\">\r\n              <div class=\"name\">{{row.userName}}</div>\r\n              <div class=\"title\">{{row.agree || '--'}}</div>\r\n            </div>\r\n          </div>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"loginAccount\" label=\"账号\"></el-table-column>\r\n      <el-table-column prop=\"school\" label=\"学校\"></el-table-column>\r\n      <el-table-column prop=\"major\" label=\"专业\"></el-table-column>\r\n      <el-table-column prop=\"tel\" label=\"手机号\" width=\"120\"></el-table-column>\r\n      <el-table-column label=\"操作\" width=\"150\" fixed=\"right\">\r\n        <template v-slot=\"{row}\">\r\n          <el-dropdown @command=\"handleCommand\">\r\n            <el-button size=\"mini\">操作<i class=\"el-icon-arrow-down\"></i></el-button>\r\n            <el-dropdown-menu slot=\"dropdown\">\r\n              <el-dropdown-item :command=\"row.id + '#edit'\">\r\n                <i class=\"el-icon-edit\"></i>修改\r\n              </el-dropdown-item>\r\n              <el-dropdown-item \r\n                v-if=\"row.loginAccount != 'admin'\" \r\n                :command=\"row.id + '#pass#' + row.userName\">\r\n                <i class=\"el-icon-key\"></i>重置密码\r\n              </el-dropdown-item>\r\n              <el-dropdown-item \r\n                v-if=\"row.loginAccount != 'admin'\" \r\n                :command=\"row.id + '#remove'\">\r\n                <i class=\"el-icon-delete\"></i>删除\r\n              </el-dropdown-item>\r\n            </el-dropdown-menu>\r\n          </el-dropdown>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 分页 -->\r\n    <el-pagination\r\n      @size-change=\"handleSizeChange\"\r\n      @current-change=\"handleCurrentChange\"\r\n      :current-page=\"search.pageNumber\"\r\n      :page-sizes=\"[10, 20, 50]\"\r\n      :page-size=\"search.pageSize\"\r\n      layout=\"total, sizes, prev, pager, next\"\r\n      :total=\"total\"\r\n      class=\"pagination\">\r\n    </el-pagination>\r\n\r\n    <!-- 弹窗组件 -->\r\n    <add-user @addUserFalse=\"addUserFalse\" :addUserVisible=\"addUserVisible\"></add-user>\r\n    <update-user @updateUserFalse=\"updateUserFalse\" :updateId=\"updateId\" :updateUserVisible=\"updateUserVisible\"></update-user>\r\n    \r\n    <!-- 重置密码弹窗 -->\r\n    <el-dialog\r\n      title=\"重置密码\"\r\n      :visible.sync=\"passwordDialogVisible\"\r\n      width=\"400px\">\r\n      <div>\r\n        <p>请输入 <span style=\"color:#7B68EE\">{{userName}}</span> 的新密码：</p>\r\n        <el-input \r\n          v-model=\"newPassword\" \r\n          show-password \r\n          placeholder=\"新密码\"\r\n          size=\"small\">\r\n        </el-input>\r\n      </div>\r\n      <div slot=\"footer\">\r\n        <el-button @click=\"passwordDialogVisible = false\" size=\"small\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"passwordSubmit\" size=\"small\">确定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {getUserPage, removeUser, resetPassword, getApeSchoolList} from '../../../api/api'\r\nimport addUser from \"../../../components/system/teacher/addTeacher\"\r\nimport updateUser from \"../../../components/system/teacher/updateTeacher\"\r\n\r\nexport default {\r\n  components: { addUser, updateUser },\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      update: [],\r\n      addUserVisible: false,\r\n      updateUserVisible: false,\r\n      passwordDialogVisible: false,\r\n      updateId: \"\",\r\n      userName: \"\",\r\n      newPassword: \"\",\r\n      search: {\r\n        userName: \"\",\r\n        tel: \"\",\r\n        school: \"\",\r\n        major: \"\",\r\n        pageNumber: 1,\r\n        pageSize: 10\r\n      },\r\n      total: 0,\r\n      tableData: [],\r\n      school: []\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getSchools()\r\n    this.query()\r\n  },\r\n  methods: {\r\n    getSchools() {\r\n      getApeSchoolList().then(res => {\r\n        if(res.code === 1000) this.school = res.data\r\n      })\r\n    },\r\n    query() {\r\n      this.loading = true\r\n      getUserPage(this.search).then(res => {\r\n        if(res.code === 1000) {\r\n          this.tableData = res.data.records\r\n          this.total = res.data.total\r\n        }\r\n        this.loading = false\r\n      })\r\n    },\r\n    refresh() {\r\n      this.search = {\r\n        ...this.search,\r\n        userName: \"\",\r\n        tel: \"\",\r\n        school: \"\",\r\n        major: \"\",\r\n        pageNumber: 1\r\n      }\r\n      this.query()\r\n    },\r\n    handleSizeChange(val) {\r\n      this.search.pageSize = val\r\n      this.query()\r\n    },\r\n    handleCurrentChange(val) {\r\n      this.search.pageNumber = val\r\n      this.query()\r\n    },\r\n    handleSelectionChange(val) {\r\n      this.update = val.map(item => item.id)\r\n    },\r\n    addUser() {\r\n      this.addUserVisible = true\r\n    },\r\n    addUserFalse() {\r\n      this.addUserVisible = false\r\n      this.query()\r\n    },\r\n    updateUser(id) {\r\n      this.updateId = id\r\n      this.updateUserVisible = true\r\n    },\r\n    updateUserBtn() {\r\n      if(this.update.length === 1) this.updateUser(this.update[0])\r\n    },\r\n    updateUserFalse() {\r\n      this.updateUserVisible = false\r\n      this.query()\r\n    },\r\n    handleCommand(command) {\r\n      const [id, action, name] = command.split('#')\r\n      if(action === 'edit') this.updateUser(id)\r\n      else if(action === 'pass') {\r\n        this.userName = name\r\n        this.userId = id\r\n        this.passwordDialogVisible = true\r\n      }\r\n      else this.deleteDate(id)\r\n    },\r\n    deleteDateBtn() {\r\n      if(this.update.length > 0) {\r\n        this.$confirm('确认删除选中教师?', '提示', {type: 'warning'})\r\n          .then(() => this.deleteDate(this.update.join(\",\")))\r\n      }\r\n    },\r\n    deleteDate(ids) {\r\n      removeUser({ids}).then(res => {\r\n        if(res.code === 1000) {\r\n          this.$message.success('删除成功')\r\n          this.query()\r\n        }\r\n      })\r\n    },\r\n    passwordSubmit() {\r\n      if(!this.newPassword) return this.$message.warning('请输入密码')\r\n      resetPassword({id: this.userId, newPassword: this.newPassword}).then(res => {\r\n        if(res.code === 1000) {\r\n          this.$message.success('重置成功')\r\n          this.passwordDialogVisible = false\r\n          this.newPassword = \"\"\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.teacher-container {\r\n  padding: 15px;\r\n  background: #f8f7fc;\r\n}\r\n\r\n.search-card {\r\n  background: white;\r\n  padding: 15px;\r\n  border-radius: 5px;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.action-bar {\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.teacher-info {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.teacher-detail {\r\n  margin-left: 10px;\r\n}\r\n\r\n.teacher-detail .name {\r\n  color: #4a2b90;\r\n  font-weight: 500;\r\n}\r\n\r\n.teacher-detail .title {\r\n  color: #888;\r\n  font-size: 12px;\r\n}\r\n\r\n.data-table {\r\n  margin-bottom: 15px;\r\n  border-radius: 5px;\r\n  overflow: hidden;\r\n}\r\n\r\n.pagination {\r\n  text-align: right;\r\n  padding: 10px 0;\r\n}\r\n\r\n.el-dropdown-menu [class^=el-icon-] {\r\n  color: #7b68ee;\r\n  margin-right: 5px;\r\n}\r\n</style>\r\n\r\n<style>\r\n.data-table .el-table__header th {\r\n  background-color: #ece9f4;\r\n  color: #4a2b90;\r\n}\r\n\r\n.data-table .el-table__body tr:hover td {\r\n  background-color: #f5f2ff !important;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}